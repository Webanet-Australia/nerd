{"version":3,"sources":["job-edit.js"],"names":["get_select_control","$this","get_tab_group","get_form_group","$btn","closest","attr","$","selectedUrl","document","ready","selectNavItem","on","dt","val","toggleClass","bt","$sel","$txt","append","find","length","jobCrawl","urls","push","uri","filters","cookies","empty","splice","prop","remove","url","select_populate","cntrl","add","bs","value","text","console","log","index","bind","t","e","preventDefault","ajax","method","data","JSON","stringify","extend","serializeFormJSON","contentType","dataType","headers","done","r","fail","listItems","$list","each","key"],"mappings":"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","file":"job-edit.js","sourcesContent":["'use strict';\n\n//Get control from grand pa's data attributes\n\nfunction get_select_control($this) {\n  return get_tab_group($this) + '-' + get_form_group($this);\n}\n\nfunction get_form_group($btn) {\n  return $btn.closest('[data-fg]').attr('data-fg');\n}\n\nfunction get_tab_group($btn) {\n  return $btn.closest('[data-bd]').attr('data-bd');\n}\n\n$(function () {\n\n  var selectedUrl = 0;\n\n  $(document).ready(function () {\n    selectNavItem('jobs');\n  });\n\n  $('input[type=\"checkbox\"]').on('click', function () {\n    var dt = '#' + $(this).attr('data-text');\n    if ($(this).attr('checked') == 'checked') {\n      $(dt).val('0');\n    } else {\n      $(dt).val('1');\n    }\n  });\n\n  $('[name=\"chk-xpath\"').on('click', function () {\n    $('#div-xpath').toggleClass('d-none');\n  });\n\n  //urls add\n  $('.btn-url-add').on('click', function () {\n\n    var bt = get_tab_group($(this));\n    var $sel = $('#sel-' + bt + '-url');\n    var $txt = $('#txt-' + bt + '-url');\n\n    $sel.append('<option value=\"' + $sel.find('option:selected').length + '\">' + $txt.val() + '</option>');\n    //console.log(bt);\n    jobCrawl[bt].urls.push({\n      uri: $txt.val(),\n      filters: [],\n      cookies: []\n    });\n\n    $txt.val('');\n\n    $('#sel-' + bt + '-filter').empty();\n    $('#sel-' + bt + '-cookie').empty();\n  });\n\n  //urls delete\n  $('.btn-url-del').on('click', function () {\n\n    var bt = get_tab_group($(this));\n    var $sel = $('#sel-' + bt + '-url');\n\n    jobCrawl[bt].urls.splice($sel.prop('selectedIndex'), 1);\n\n    $sel.find('option:selected').remove();\n\n    $('#sel-' + bt + '-filter').empty();\n    $('#sel-' + bt + '-cookie').empty();\n  });\n\n  //url's select Click\n  $('.sel-url').on('click', function () {\n\n    var bt = get_tab_group($(this));\n\n    selectedUrl = $('#sel-' + bt + '-url').prop('selectedIndex');\n\n    var url = jobCrawl[bt].urls[selectedUrl];\n\n    select_populate(url.filters, $('#sel-' + bt + '-filter'));\n    select_populate(url.cookies, $('#sel-' + bt + '-cookie'));\n  });\n\n  /**\n   * Filters and Cookie Selects (select,list,add/delete)\n  **/\n\n  //Select List Add\n  $('.btn-list-add').on('click', function () {\n\n    var cntrl = get_select_control($(this));\n    //console.log(cntrl);\n    var add = $('#txt-' + cntrl).val();\n    var bt = get_tab_group($(this));\n    var bs = get_form_group($(this)) + 's';\n\n    if (add.length) {\n\n      $('#sel-' + cntrl).append($('<option>', {\n        value: add,\n        text: add\n      }));\n\n      $('#txt-' + cntrl).val('');\n      console.log(bt);\n      jobCrawl[bt].urls[selectedUrl][bs].push(add);\n    }\n  });\n\n  //Select List Delete\n  $('.btn-list-del').on('click', function () {\n    var cntrl = get_select_control($(this));\n    var index = $('#sel-' + cntrl).prop('selectedIndex');\n    var bt = get_tab_group($(this));\n    var bs = get_form_group($(this)) + 's';\n\n    $('#sel-' + cntrl).find('option:selected').remove();\n    $('#txt-' + cntrl).val('');\n\n    jobCrawl[bt].urls[selectedUrl][bs].splice(index, 1);\n  });\n\n  //Select Lists Click\n  $('.sel-lists').bind('click', function () {\n\n    var cntrl = get_select_control($(this));\n\n    var t = $('#sel-' + cntrl + ' option:selected').text();\n\n    $('#txt-' + cntrl).val(t);\n  });\n});\n\n//Edit Job Form Submit\n$(\".btn-submit\").on(\"click\", function (e) {\n  e.preventDefault();\n\n  $.ajax({\n    method: 'POST',\n    url: '/jobs/' + $('#txt-job').val(),\n    data: JSON.stringify($.extend(jobCrawl, $('#frm-jobs-edit').serializeFormJSON())),\n    contentType: \"application/json\",\n    dataType: \"json\",\n    headers: {\n      'Accept': 'application/json'\n    }\n  }).done(function (r) {\n\n    if (r['code'] == 200) {\n      //document.location = '/jobs/list';\n    }\n  }).fail(function (r) {\n    console.log('erorr');\n    console.log(r);\n    //  alertResponse(r);\n  });\n});\n\n//populate select lists (filters + cookies)\nfunction select_populate(listItems, $list) {\n  $list.empty();\n  $.each(listItems, function (key, value) {\n    $list.append($('<option/>', {\n      value: key,\n      text: value\n    }));\n  });\n}\n//# sourceMappingURL=job-edit.js.map\n//# sourceMappingURL=job-edit.js.map\n"]}