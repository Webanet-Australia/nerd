"use strict";var map,ItemMap={bounds:null,map:null},Grid={table:null};ItemMap.init=function(t,n,a,o,e){var i={zoom:a,center:n,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map($(t)[0],i),this.bounds=new google.maps.LatLngBounds,this.usr=o,this.pwd=e,map=this.map},ItemMap.draw=function(t){$(t).each(function(t,n){var a=parseFloat(n.lat),o=parseFloat(n.lng),e=new google.maps.LatLng(a,o);ItemMap.bounds.extend(e);var i=ItemMap.mark(e),l=new google.maps.InfoWindow,s="<h4>"+n.address+"</h4>",r=["item_id","document_id","lat","lng","_version_","latlong"];$.each(n,function(t,n){-1==$.inArray(t,r)&&(s+="<p>"+t+": "+n+"</p>")}),google.maps.event.addListener(i,"click",function(){l.setContent(s),l.open(ItemMap.map,i)});var p=new google.maps.LatLng(a,o);map.panTo(p)})},ItemMap.mark=function(t){return new google.maps.Marker({position:t,map:ItemMap.map})},Grid.init=function(t){this.table=t},Grid.draw=function(t){var a=["_version_","latlong","id","item_id","document_id"],o="<thead><tr>";$.each(t[0],function(t,n){-1==$.inArray(t,a)&&(o+="<th>"+t+"</th>")}),o+="</tr></thead><tbody>",$(t).each(function(t,n){o+="<tr>",$.each(n,function(t,n){-1==$.inArray(t,a)&&(o+="<td>"+n+"</td>")}),o+="</tr>"}),o+="</tbody>",this.table.append(o)},$(function(){if($(document).ready(function(){selectNavItem("solr")}),$("#map").length){var t=new google.maps.LatLng($("#maps-lat").val(),$("#maps-lng").val());ItemMap.init("#map",t,6),Grid.init($("#solr-table table")),$.ajax({url:$("#solr-url").val()+$("#solr-core").val()+"/select?",data:"q=*:*&d=20&rows=1000&start=0&fq={!geofilt sfield=latlong}&pt="+$("#maps-lat").val()+","+$("#maps-lng").val()+"&d=100",dataType:"jsonp",headers:{Authorization:"Basic "+btoa($("#solr-usr").val()+":"+$("#solr-pwd").val())}}).done(function(t){var n=t.response.docs;ItemMap.draw(n),Grid.draw(n)})}$("#btn-view").on("click",function(){$(".page-view").toggle(),$(this).find("span").toggleClass("fa-map"),$(this).find("span").toggleClass("fa-table")}),$("#btn-import").on("click",function(){document.location="/solr/import"}),$("#btn-search").on("click",function(){document.location="/solr/"}),$("#uploads").on("click","#btn-new",function(){document.location="/solr/import"}),$(".show-detail").on("click",function(){$(this).text("Show"==$(this).text()?"Hide":"Show")}),$("#btn-help").on("click",function(){$("div.import-help").toggle()}),$("#btn-columns").on("click",function(){$("#ul-columns").toggle()})});