{"version":3,"sources":["map.js"],"names":["ItemMap","bounds","map","init","selector","center","zoom","map_options","mapTypeId","google","maps","MapTypeId","ROADMAP","Map","$","LatLngBounds","draw","data","get","xml","find","each","lat","parseFloat","text","lng","p","LatLng","extend","m","mark","infoWindow","InfoWindow","html","ex","children","key","value","t","prop","inArray","event","addListener","setContent","open","panTo","Marker","position"],"mappings":"AAAA;;AAEA;;AAEA,IAAIA,UAAU;AACZC,UAAQ,IADI;AAEZC,OAAK;AAFO,CAAd;AAIA,IAAIA,GAAJ;;AAEAF,QAAQG,IAAR,GAAe,UAAUC,QAAV,EAAoBC,MAApB,EAA4BC,IAA5B,EAAkC;AAC/C,MAAIC,cAAc;AAChBD,UAAMA,IADU;AAEhBD,YAAQA,MAFQ;AAGhBG,eAAWC,OAAOC,IAAP,CAAYC,SAAZ,CAAsBC;AAHjB,GAAlB;AAKA,OAAKV,GAAL,GAAW,IAAIO,OAAOC,IAAP,CAAYG,GAAhB,CAAoBC,EAAEV,QAAF,EAAY,CAAZ,CAApB,EAAoCG,WAApC,CAAX;AACA,OAAKN,MAAL,GAAc,IAAIQ,OAAOC,IAAP,CAAYK,YAAhB,EAAd;AACAb,QAAM,KAAKA,GAAX;AACD,CATD;;AAWAF,QAAQgB,IAAR,GAAe,UAAUC,IAAV,EAAgB;AAC7BH,IAAEI,GAAF,CAAMD,IAAN,EAAY,UAAUE,GAAV,EAAe;AACzB;AACAL,MAAEK,GAAF,EAAOC,IAAP,CAAY,QAAZ,EAAsBC,IAAtB,CAA2B,YAAY;;AAErC,UAAIC,MAAMC,WAAWT,EAAE,IAAF,EAAQM,IAAR,CAAa,KAAb,EAAoBI,IAApB,EAAX,CAAV;AACA,UAAIC,MAAMF,WAAWT,EAAE,IAAF,EAAQM,IAAR,CAAa,KAAb,EAAoBI,IAApB,EAAX,CAAV;;AAEA,UAAIE,IAAI,IAAIjB,OAAOC,IAAP,CAAYiB,MAAhB,CAAuBL,GAAvB,EAA4BG,GAA5B,CAAR;;AAEA;AACAzB,cAAQC,MAAR,CAAe2B,MAAf,CAAsBF,CAAtB;;AAEA,UAAIG,IAAI7B,QAAQ8B,IAAR,CAAaJ,CAAb,CAAR;;AAEA;AACA,UAAIK,aAAa,IAAItB,OAAOC,IAAP,CAAYsB,UAAhB,EAAjB;;AAEA;AACA,UAAIC,OAAO,SAASnB,EAAE,IAAF,EAAQM,IAAR,CAAa,SAAb,EAAwBI,IAAxB,EAAT,GAA0C,OAArD;AACA,UAAIU,KAAK,CAAC,SAAD,EAAY,aAAZ,EAA2B,KAA3B,EAAkC,KAAlC,CAAT;;AAEApB,QAAE,IAAF,EAAQqB,QAAR,GAAmBd,IAAnB,CAAwB,UAAUe,GAAV,EAAeC,KAAf,EAAsB;AAC5C;AACA,YAAIC,IAAIxB,EAAEuB,KAAF,EAASE,IAAT,CAAc,SAAd,CAAR;AACA;AACA,YAAIzB,EAAE0B,OAAF,CAAUF,CAAV,EAAaJ,EAAb,KAAoB,CAAC,CAAzB,EAA4B;AAC1BD,kBAAQ,QAAQK,CAAR,GAAY,IAAZ,GAAmBxB,EAAEuB,KAAF,EAASb,IAAT,EAAnB,GAAqC,MAA7C;AACD;AACF,OAPD;;AASA;AACAf,aAAOC,IAAP,CAAY+B,KAAZ,CAAkBC,WAAlB,CAA8Bb,CAA9B,EAAiC,OAAjC,EAA0C,YAAY;AACpDE,mBAAWY,UAAX,CAAsBV,IAAtB;AACAF,mBAAWa,IAAX,CAAgB5C,QAAQE,GAAxB,EAA6B2B,CAA7B;AACD,OAHD;;AAKA;;;;;;;;;;;AAWA,UAAIxB,SAAS,IAAII,OAAOC,IAAP,CAAYiB,MAAhB,CAAuBL,GAAvB,EAA4BG,GAA5B,CAAb;AACA;AACAvB,UAAI2C,KAAJ,CAAUxC,MAAV;AACD,KAhDD;AAiDD,GAnDD;;AAqDA;AACA;AACD,CAxDD;;AA0DAL,QAAQ8B,IAAR,GAAe,UAAUJ,CAAV,EAAa;AAC1B;AACA,SAAO,IAAIjB,OAAOC,IAAP,CAAYoC,MAAhB,CAAuB;AAC5BC,cAAUrB,CADkB;AAE5BxB,SAAKF,QAAQE;AAFe,GAAvB,CAAP;AAID,CAND;AAOA;AACA;AACA","file":"map.js","sourcesContent":["'use strict';\n\n// http://articles.sitepoint.com/article/google-maps-api-jquery\n\nvar ItemMap = {\n  bounds: null,\n  map: null\n};\nvar map;\n\nItemMap.init = function (selector, center, zoom) {\n  var map_options = {\n    zoom: zoom,\n    center: center,\n    mapTypeId: google.maps.MapTypeId.ROADMAP\n  };\n  this.map = new google.maps.Map($(selector)[0], map_options);\n  this.bounds = new google.maps.LatLngBounds();\n  map = this.map;\n};\n\nItemMap.draw = function (data) {\n  $.get(data, function (xml) {\n    //console.log(xml);\n    $(xml).find('marker').each(function () {\n\n      var lat = parseFloat($(this).find('lat').text());\n      var lng = parseFloat($(this).find('lng').text());\n\n      var p = new google.maps.LatLng(lat, lng);\n\n      // Extend the bounds to include the new point\n      ItemMap.bounds.extend(p);\n\n      var m = ItemMap.mark(p);\n\n      // Create the tooltip and its text\n      var infoWindow = new google.maps.InfoWindow();\n\n      //echo this;\n      var html = '<h4>' + $(this).find('address').text() + '</h4>';\n      var ex = [\"ITEM_ID\", \"DOCUMENT_ID\", \"LNG\", \"LAT\"];\n\n      $(this).children().each(function (key, value) {\n        //tag name\n        var t = $(value).prop(\"tagName\");\n        //exclude value\n        if ($.inArray(t, ex) == -1) {\n          html += '<p>' + t + ': ' + $(value).text() + '</p>';\n        }\n      });\n\n      // Add a listener\n      google.maps.event.addListener(m, 'click', function () {\n        infoWindow.setContent(html);\n        infoWindow.open(ItemMap.map, m);\n      });\n\n      /*\n      var circle = new google.maps.Circle({\n            radius: 70*1000,\n            center: point,\n            map: ItemMap.map,\n            fillColor: '#FF0000',\n            fillOpacity: 0.2,\n            strokeColor: '#FF0000',\n            strokeOpacity: 0.6\n      });\n      */\n      var center = new google.maps.LatLng(lat, lng);\n      // using global variable:\n      map.panTo(center);\n    });\n  });\n\n  // Fit the map around the markers we added:\n  //ItemMap.map.fitBounds(ItemMap.bounds);\n};\n\nItemMap.mark = function (p) {\n  // Add the marker itself\n  return new google.maps.Marker({\n    position: p,\n    map: ItemMap.map\n  });\n};\n//# sourceMappingURL=map.js.map\n//# sourceMappingURL=map.js.map\n//# sourceMappingURL=map.js.map\n"]}